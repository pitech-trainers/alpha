{% extends 'BookshopBookshopBundle::layout.html.twig' %}

{% block content %}

 <div class="main-container col3-layout">
                    <div class="main">
                        <div class="breadcrumbs">
                            <ul>
                                <li class="home">
                                    <a href="{{ path('bookshop_bookshop_homepage') }}" title="Go to Home Page">{{ "Home"|trans }}</a>
                                    <span>/ </span>
                                </li>
                                <li class="category35">
                                    <strong>{{ label }}</strong>
                                </li>
                            </ul>
                        </div>
                        <div class="col-wrapper">
                            <div class="col-main">
                                <div class="page-title category-title">
                                    <h1>{{ label }}</h1>
                                </div>                           
                                <div class="category-products">
                                    <div class="toolbar">
                                        <div class="pager">
                                            <p class="amount">
                                                <strong>{{ pagination.getTotalItemCount }} {{ "Item(s)"|trans }}</strong>
                                            </p>
                                          {{ knp_pagination_render(pagination) }}                                     
                                        </div>   
                                        {% if pagination.getTotalItemCount>0 %}
                                        <div class="sorter">
                                            <div class="sort-by">
                                                <form method="get">
                                                    <label>{{ "Sort By"|trans }}</label>
                                                   <select name='sortBy'>
                                                     <option {% if pagination.isSorted('title') %} selected="selected" {% endif %}>{{ knp_pagination_sortable(pagination, 'title', 'title') }}</option>
                                                     <option {% if pagination.isSorted('price') %} selected="selected" {% endif %}>{{ knp_pagination_sortable(pagination, 'price', 'price') }}</option>
                                                   </select>
                                                    &nbsp;
                                                    <label>{{ "Direction"|trans }}</label>
                                                    <select name='direction'>
                                                       <option {% if pagination.isSorted('desc') %} selected="selected" {% endif %}>{{ knp_pagination_sortable(pagination, 'desc', 'desc') }}</option>
                                                       <option {% if pagination.isSorted('asc') %} selected="selected" {% endif %}>{{ knp_pagination_sortable(pagination, 'asc', 'asc') }}</option>                                                   
                                                    </select>
                                                    {% if (app.request.query.has('price')) %} <input type="hidden" value="{{ app.request.get('price')}}" name="price"> {% endif %}
                                                    {% if (app.request.query.has('stock')) %} <input type="hidden" value="{{ app.request.get('stock')}}" name="stock"> {% endif %}
                                                    {% if (app.request.query.has('cid')) %} <input type="hidden" value="{{ app.request.get('cid')}}" name="cid"> {% endif %}
                                                    {% if (app.request.query.has('label')) %} <input type="hidden" value="{{ app.request.get('label')}}" name="label"> {% endif %}
                                                    {% if (app.request.query.has('search')) %} <input type="hidden" value="{{ app.request.get('search')}}" name="search"> {% endif %}
                                                    <input type="submit" />
                                                 </form>
                                            </div>
                                        </div>
                                        {% endif %}
                                    </div>                                 
                                   <ul class="products-grid">
                                   {% for product in pagination %}                                  
                                      {% if  (loop.index%3==1) %}   
                                        <li class="item first">
                                            <a href="{{ path('bookshop_bookshop_productDetail',{'pid': product.id})}}" title="{{ product.title }}" class="product-image"><img src="{{ asset('bundles/bookshopbookshop/product_images/'~product.image.path~product.image.filename) }}" width="135" height="135" alt="Nusantara Demo" /></a>
                                            <h2 class="product-name"><a href="{{ path('bookshop_bookshop_productDetail',{'pid': product.id})}}" title="{{ product.Title }}">{{ product.Title }}</a></h2>
                                            <div class="price-box">
                                                <span class="regular-price" id="product-price-168">
                                                    <span class="price">{{ product.Price }} US$</span>
                                                </span>
                                            </div>
                                            <div class="actions">
                                                <button type="button" title="Add to Cart" class="button btn-cart" >
                                                    <span><span>{{ "Add to Cart"|trans }}</span></span>
                                                </button>
                                            </div>
                                        </li>
                                         {% endif %}
                                         {% if  (loop.index%3==2) %}
                                        <li class="item">
                                            <a href="{{ path('bookshop_bookshop_productDetail',{'pid': product.id})}}" title="{{ product.Title }}" class="product-image">
                                                <img src="{{ asset('bundles/bookshopbookshop/product_images/'~product.image.path~product.image.filename) }}" width="135" height="135" alt="{{ product.Title }}" />
                                            </a>
                                            <h2 class="product-name">
                                                <a href="{{ path('bookshop_bookshop_productDetail',{'pid': product.id})}}" title="{{ product.Title }}"> {{ product.Title }}</a>
                                            </h2>
                                            <div class="price-box">
                                                <span class="regular-price" id="product-price-170">
                                                    <span class="price">{{ product.Price }} US$</span>
                                                </span>
                                            </div>
                                            <div class="actions">
                                                <button type="button" title="Add to Cart" class="button btn-cart" >
                                                    <span><span>{{ "Add to Cart"|trans }}</span></span>
                                                </button>
                                            </div>
                                        </li>
                                        {% endif %}
                                        {% if  (loop.index%3==0) %}
                                        <li class="item">
                                            <a href="{{ path('bookshop_bookshop_productDetail',{'pid': product.id})}}" title=" {{ product.Title }}" class="product-image">
                                                <img src="{{ asset('bundles/bookshopbookshop/product_images/'~product.image.path~product.image.filename) }}" width="135" height="135" alt=" {{ product.Title }}" />
                                            </a>
                                            <h2 class="product-name">
                                                <a href="{{ path('bookshop_bookshop_productDetail',{'pid': product.id})}}" title="{{ product.Title }}"> {{ product.Title }}</a>
                                            </h2>
                                            <div class="price-box">
                                                <span class="regular-price" id="product-price-170">
                                                    <span class="price">{{ product.Price }} US$</span>
                                                </span>
                                            </div>
                                            <div class="actions">
                                                <button type="button" title="Add to Cart" class="button btn-cart" >
                                                    <span><span>{{ "Add to Cart"|trans }}</span></span>
                                                </button>
                                            </div>
                                        </li>                                
                                         {% endif %}                                     
                            {% else %}
                                <p>{{ "There are no products"|trans }}...</p>
                            {% endfor %}	
                                </ul>                                    
                                    <div class="toolbar-bottom">
                                        <div class="toolbar">
                                            <div class="pager">
                                                {{ knp_pagination_render(pagination) }}
                                                <p class="amount">
                                                    <strong>{{ pagination.getTotalItemCount }} Item(s)</strong>
                                                </p>  
                                             {% if pagination.getTotalItemCount>0 %}
                                            <div class="sorter">
                                                <div class="sort-by">
                                                   <form method="get">
                                                    <label>{{ "Sort By"|trans }}</label>
                                                   <select name='sortBy'>
                                                     <option {% if pagination.isSorted('title') %} selected="selected" {% endif %}>{{ knp_pagination_sortable(pagination, 'title', 'title') }}</option>
                                                     <option {% if pagination.isSorted('price') %} selected="selected" {% endif %}>{{ knp_pagination_sortable(pagination, 'price', 'price') }}</option>
                                                   </select>
                                                    &nbsp;
                                                    <label>{{ "Direction"|trans }}</label>
                                                    <select name='direction'>
                                                       <option {% if pagination.isSorted('desc') %} selected="selected" {% endif %}>{{ knp_pagination_sortable(pagination, 'desc', 'desc') }}</option>
                                                       <option {% if pagination.isSorted('asc') %} selected="selected" {% endif %}>{{ knp_pagination_sortable(pagination, 'asc', 'asc') }}</option>
                                                    </select>
                                                    {% if (app.request.query.has('price')) %} <input type="hidden" value="{{ app.request.get('price')}}" name="price"> {% endif %}
                                                    {% if (app.request.query.has('stock')) %} <input type="hidden" value="{{ app.request.get('stock')}}" name="stock"> {% endif %}
                                                    {% if (app.request.query.has('cid')) %} <input type="hidden" value="{{ app.request.get('cid')}}" name="cid"> {% endif %}
                                                    {% if (app.request.query.has('label')) %} <input type="hidden" value="{{ app.request.get('label')}}" name="label"> {% endif %}
                                                    {% if (app.request.query.has('search')) %} <input type="hidden" value="{{ app.request.get('search')}}" name="search"> {% endif %}
                                                    <input type="submit" />
                                                 </form>
                                                </div>
                                            </div>
                                             {% endif %}   
                                        </div>
                                    </div>                                         
                                </div>
                            </div>                              
                        </div>
                                {% block leftsidebar%}
                               <div class="col-left sidebar">
                                <div class="block block-layered-nav">
                                    <div class="block-title">
                                        <strong><span>{{ "Shop By"|trans }}</span></strong>
                                    </div>
                                    <div class="block-content">
                                        <div class="currently">
                                            <p class="block-subtitle">{{ "Currently Shopping by"|trans }}:</p>
                                            <ol>
                                             {% if (app.request.query.has('cid')) %}
                                              <li>
                                                    <span class="label">{{ "Category"|trans }}:</span>
                                                    {%for category in categories%}
                                                      {% if app.request.query.get('cid') == category.id %}    
                                                        <span class="value">{{category.label}}</span>
                                                      {% endif %}
                                                    {% endfor%}
                                              </li>
                                             {%endif%}
                                             {% if (app.request.query.has('price')) %}
                                             <li>
                                                    <span class="label">{{ "Price"|trans }}:</span>
                                                    {% if app.request.query.get('price') == 1 %}    
                                                        <span class="value">00.00 $US-49.99 $US</span>
                                                    {% elseif app.request.query.get('price') == 2 %}
                                                        <span class="value">50.00 $US-99.99 $US</span>
                                                    {% elseif app.request.query.get('price') == 3 %}
                                                        <span class="value">100.00 $US and above</span>
                                                    {% endif %}
                                             </li>  
                                             {% endif %}
                                             {% if (app.request.query.has('stock')) %}
                                             <li>
                                                    <span class="label">{{ "Stock"|trans }}:</span>
                                                    {% if app.request.query.get('stock') == 1 %}    
                                                        <span class="value">{{ "Available"|trans }}</span>
                                                    {% elseif app.request.query.get('stock') == 0 %}
                                                        <span class="value">{{ "Soon"|trans }}</span>                                              
                                                    {% endif %}
                                             </li>  
                                             {% endif %}                                                                                                                              
                                            </ol>
                                        </div>
                                        <div class="actions">
                                            
                                         {% if (app.request.attributes.get('_route' )== 'bookshop_bookshop_category')%} 
                                            {% if (app.request.query.has('sortBy')) %}
                                              <a href="{{ path('bookshop_bookshop_category',{'sortBy':app.request.query.get('sortBy'),'direction':app.request.query.get('direction')})}}">Clear All</a>
                                            {% else %}
                                               <a href="{{ path('bookshop_bookshop_category',{'cid':pagination.params.cid,'label':pagination.params.label })}}">Clear All</a>
                                            {% endif %}
                                         {% endif %}
                                               
                                         {% if (app.request.attributes.get('_route' )== 'bookshop_bookshop_search')%} 
                                          {% if (app.request.query.has('sortBy')) %}
                                             <a href="{{ path('bookshop_bookshop_search',{'sortBy':app.request.query.get('sortBy'),'direction':app.request.query.get('direction')})}}">Clear All</a>
                                            {% else %}
                                             <a href="{{ path('bookshop_bookshop_search')}}">Clear All</a>
                                          {% endif %} 
                                         {% endif %}
                                        </div>
                                        <p class="block-subtitle">{{ "Shopping Options"|trans }}</p>
                                        <dl id="narrow-by-list">
                                            {% if (app.request.attributes.get('_route' )== 'bookshop_bookshop_search')%}
                                            <dt>{{ "Category"|trans }}</dt>
                                            <dd>
                                                <ol>
                                                    {% for category in categories %}
                                                    <li><a href="{{ path(app.request.attributes.get('_route' ),app.request.query.all|merge({'cid':category.id})) }}">
                                                        {{category.label}}                                                        
                                                        </a>
                                                    </li>  
                                                    {% endfor %}
                                                </ol>
                                            </dd>
                                            {% endif %}
                                            <dt>{{ "Price"|trans }}</dt>
                                            <dd>
                                                <ol>                                                                                                 
                                                    <li><a href="{{ path(app.request.attributes.get('_route' ),app.request.query.all|merge({'price':'1'})) }}">
                                                            <span class="price">0,00 US$</span> - <span class="price">49,99 US$</span>
                                                        </a>                                                          
                                                    </li>
                                                    <li><a href="{{ path(app.request.attributes.get('_route' ),app.request.query.all|merge({'price':'2'})) }}">
                                                            <span class="price">50,00 US$</span> - <span class="price">99,99 US$</span>
                                                        </a>
                                                    </li>
                                                    <li><a href="{{ path(app.request.attributes.get('_route' ),app.request.query.all|merge({'price':'3'})) }}">
                                                            <span class="price">100,00 US$</span> and above
                                                        </a>
                                                    </li>                                                                                                   
                                                </ol>
                                            </dd>                                     
                                            <dt>{{ "Stock"|trans }}</dt>
                                            <dd>
                                                <ol>
                                                    <li><a href="{{ path(app.request.attributes.get('_route' ),app.request.query.all|merge({'stock':'1'})) }}">
                                                        {{ "Available"|trans }}
                                                        
                                                        </a>
                                                    </li>
                                                    <li><a href="{{ path(app.request.attributes.get('_route' ),app.request.query.all|merge({'stock':'0'})) }}">                                                           
                                                       {{ "Soon"|trans }}
                                                        </a>
                                                    </li>
                                                </ol>
                                            </dd>
                                  
                                        </dl>
                                    </div>
                                </div>
                            </div>
                              {% endblock %}                        
                    </div>
                   {% block rightsidebar %}
                   {% endblock%}
                </div>
         </div>
{% endblock %}
